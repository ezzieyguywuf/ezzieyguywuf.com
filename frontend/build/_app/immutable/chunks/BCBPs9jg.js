import{p as o,r as m,q as d,v,w as p,x as l,y as u,z as _,A as b,B as g,C as k,D as w,E as y,F,G as x,H as A,I as E}from"./ROgFvJsU.js";class M{anchor;#s=new Map;#t=new Map;#e=new Map;#a=!0;constructor(t,a=!0){this.anchor=t,this.#a=a}#r=()=>{var t=o;if(this.#s.has(t)){var a=this.#s.get(t),s=this.#t.get(a);if(s)m(s);else{var e=this.#e.get(a);e&&(this.#t.set(a,e.effect),this.#e.delete(a),e.fragment.lastChild.remove(),this.anchor.before(e.fragment),s=e.effect)}for(const[r,i]of this.#s){if(this.#s.delete(r),r===t)break;const f=this.#e.get(i);f&&(d(f.effect),this.#e.delete(i))}for(const[r,i]of this.#t){if(r===a)continue;const f=()=>{if(Array.from(this.#s.values()).includes(r)){var h=document.createDocumentFragment();b(i,h),h.append(p()),this.#e.set(r,{effect:i,fragment:h})}else d(i);this.#t.delete(r)};this.#a||!s?v(i,f,!1):f()}}};ensure(t,a){var s=o,e=g();if(a&&!this.#t.has(t)&&!this.#e.has(t))if(e){var r=document.createDocumentFragment(),i=p();r.append(i),this.#e.set(t,{effect:l(()=>a(i)),fragment:r})}else this.#t.set(t,l(()=>a(this.anchor)));if(this.#s.set(s,t),e){for(const[f,n]of this.#t)f===t?s.skipped_effects.delete(n):s.skipped_effects.add(n);for(const[f,n]of this.#e)f===t?s.skipped_effects.delete(n.effect):s.skipped_effects.add(n.effect);s.add_callback(this.#r)}else u&&(this.anchor=_),this.#r()}}function C(c,t,...a){var s=new M(c);k(()=>{const e=t()??null;s.ensure(e,e&&(r=>e(r,...a)))},A)}function D(c){return(t,...a)=>{var s=c(...a),e;if(u)e=_,w();else{var r=s.render().trim(),i=y(r);e=E(i),t.before(e)}const f=s.setup?.(e);F(e,e),typeof f=="function"&&x(f)}}export{M as B,D as c,C as s};
